"use strict";(self.webpackChunkmaterial_pro_angular_lite=self.webpackChunkmaterial_pro_angular_lite||[]).push([[828],{7828:(tt,y,s)=>{s.r(y),s.d(y,{SupportModule:()=>K});var c=s(4755),T=s(2480),x=s(5861),f=s(3276),u=s(5580),t=s(2223),m=s(3144),S=s(4004);let v=(()=>{class n{constructor(e){this.http=e}getsupportData(e){const r=new m.WM({Authorization:`Bearer ${e.token}`}),i=(new m.LE).set("page",e.page).set("limit",e.limit);return this.http.get("https://api.cryptozack.com/user-account/list-support",{headers:r,params:i}).pipe((0,S.U)(l=>l))}getsupportUserData(e){const r=new m.WM({Authorization:`Bearer ${e.token}`}),i=(new m.LE).set("supportId",e.supportId);return this.http.get("https://api.cryptozack.com/user-account/support-byId",{headers:r,params:i}).pipe((0,S.U)(l=>l))}replyToUser(e){return this.http.post("https://api.cryptozack.com/user-account/support-reply",e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(m.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var g=s(6081),d=s(9401),h=s(430),Z=s(8097),_=s(3649),M=s(9383);const D=["chatContainer"];function A(n,a){1&n&&(t.TgZ(0,"div",14),t._UZ(1,"ngx-ui-loader",15),t.qZA()),2&n&&(t.xp6(1),t.Q6J("hasProgressBar",!1))}const N=function(n,a){return{left:n,right:a}};function O(n,a){if(1&n&&(t.TgZ(0,"div",16)(1,"p",17),t._uU(2),t.qZA(),t.TgZ(3,"p",18),t._uU(4),t.qZA()()),2&n){const e=a.$implicit,o=t.oxw();t.Q6J("ngClass",t.WLB(3,N,"issue"===e.type,"replies"===e.type)),t.xp6(2),t.Oqu(e.text),t.xp6(2),t.Oqu(o.getTimeDifference(e.timestamp))}}let U=(()=>{class n{constructor(e,o,r){this.supportService=e,this.dialogRef=o,this.data=r,this.replyMessage="",this.chatData=[],this.showLoader=!1;let i=localStorage.getItem("userinfo");i&&(this.parseData=JSON.parse(i))}ngOnInit(){this.getSupport(),this.supportInterval=setInterval(()=>{this.getSupport()},1e4)}ngOnDestroy(){clearInterval(this.supportInterval)}ngAfterViewChecked(){this.scrollToBottom()}scrollToBottom(){try{this.chatContainer.nativeElement.scrollTop=this.chatContainer.nativeElement.scrollHeight}catch{}}getSupport(){this.supportService.getsupportUserData({token:this.parseData.token,supportId:this.data.id}).subscribe(o=>{if(this.clientData=o.data,this.clientData.issue&&Array.isArray(this.clientData.issue))for(let r=0;r<this.clientData.issue.length;r++)this.clientData.issue[r].type="issue";if(this.clientData.replies&&Array.isArray(this.clientData.replies))for(let r=0;r<this.clientData.replies.length;r++)this.clientData.replies[r].type="replies";this.sortedMessages=this.sortMessages([...this.clientData.issue||[],...this.clientData.replies||[]])})}sortMessages(e){return e.sort((o,r)=>new Date(o.timestamp).getTime()-new Date(r.timestamp).getTime())}getTimeDifference(e){const o=new Date(e).getTime(),r=Date.now(),i=Math.floor((r-o)/6e4);return i<1?"Just now":i<60?i+" min ago":i<1440?Math.floor(i/60)+" hours "+i%60+" min ago":i<17280?Math.floor(i/1440)+" days "+Math.floor(i%1440/60)+" hours ago":Math.floor(i/1440)+" days ago"}replyToUser(){this.replyMessage.length>0&&this.supportService.replyToUser({supportId:this.data.id,replies:this.replyMessage}).subscribe(o=>{o&&(this.getSupport(),this.replyMessage="")})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v),t.Y36(u.so),t.Y36(u.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-reply"]],viewQuery:function(e,o){if(1&e&&t.Gf(D,5),2&e){let r;t.iGM(r=t.CRH())&&(o.chatContainer=r.first)}},decls:18,vars:5,consts:[["class","ngxLoader",4,"ngIf"],[1,"toolbar"],[2,"text-transform","capitalize"],[1,"spacer"],["mat-dialog-close","","matTooltip","Close",1,"pointer"],[2,"height","400px"],["id","chat_container",1,"chat_container"],["chatContainer",""],["class","message",3,"ngClass",4,"ngFor","ngForOf"],[1,"reply_container"],[1,"replyField"],["matInput","","placeholder","Send a message...",1,"searchInput",3,"ngModel","ngModelChange","keyup.enter"],["input",""],["matTooltip","Send",1,"sendIcon",3,"click"],[1,"ngxLoader"],[3,"hasProgressBar"],[1,"message",3,"ngClass"],[1,"messages"],[1,"timestamp"]],template:function(e,o){1&e&&(t.YNc(0,A,2,1,"div",0),t.TgZ(1,"div",1)(2,"mat-toolbar",1)(3,"span",2),t._uU(4),t.qZA(),t._UZ(5,"div",3),t.TgZ(6,"mat-icon",4),t._uU(7,"close"),t.qZA()()(),t.TgZ(8,"div",5)(9,"div",6,7),t.YNc(11,O,5,6,"div",8),t.qZA(),t.TgZ(12,"div",9)(13,"div",10)(14,"input",11,12),t.NdJ("ngModelChange",function(i){return o.replyMessage=i})("keyup.enter",function(){return o.replyToUser()}),t.qZA(),t.TgZ(16,"mat-icon",13),t.NdJ("click",function(){return o.replyToUser()}),t._uU(17,"send"),t.qZA()()()()),2&e&&(t.Q6J("ngIf",o.showLoader),t.xp6(4),t.AsE("",o.data.user.firstName," ",o.data.user.lastName,""),t.xp6(7),t.Q6J("ngForOf",o.sortedMessages),t.xp6(3),t.Q6J("ngModel",o.replyMessage))},dependencies:[c.mk,c.sg,c.O5,g.Eo,d.Fj,d.JJ,d.On,h.Hw,Z.Nt,_.gM,M.Ye,u.ZT],styles:[".toolbar[_ngcontent-%COMP%]{background-color:#1e88e5;color:#fff}.reply_container[_ngcontent-%COMP%]{align-items:baseline;text-align:center}.replyField[_ngcontent-%COMP%]{width:400px;display:flex;align-self:baseline;margin:20px}.replyField[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:400px;height:45px;border:1px solid #CCCBCB;border-radius:25px;background-color:#fff;padding-left:15px}.replyField[_ngcontent-%COMP%]   .sendIcon[_ngcontent-%COMP%]{width:20px;height:20px;color:#8c8888;background-color:#fff;margin-left:-32px;margin-top:10px;cursor:pointer}.replyField[_ngcontent-%COMP%]   .sendIcon[_ngcontent-%COMP%]:hover{color:#464141}.chat_container[_ngcontent-%COMP%]{padding:5px}.chat_container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:300px;overflow-y:scroll}.message[_ngcontent-%COMP%]{padding:5px;margin:5px;max-width:70%;word-wrap:break-word;line-height:10px}.message[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:5px}.message[_ngcontent-%COMP%]   .timestamp[_ngcontent-%COMP%]{font-size:10px;text-align:right;margin-bottom:0}.message.left[_ngcontent-%COMP%]{align-self:flex-start;background-color:#f0f0f0;border-radius:5px}.message.right[_ngcontent-%COMP%]{align-self:flex-end;background-color:#d5e8d4;border-radius:5px}"]}),n})();var p=s(3627);function w(n,a){1&n&&(t.TgZ(0,"div",21),t._UZ(1,"ngx-ui-loader",22),t.qZA()),2&n&&(t.xp6(1),t.Q6J("hasProgressBar",!1))}function I(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Name "),t.qZA())}function P(n,a){if(1&n&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.AsE(" ",e.user.firstName," ",e.user.lastName," ")}}function Y(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Email"),t.qZA())}function R(n,a){if(1&n&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",e.user.email," ")}}function J(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Title "),t.qZA())}function Q(n,a){if(1&n&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",e.title," ")}}function k(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Date & Time "),t.qZA())}function B(n,a){if(1&n&&(t.TgZ(0,"td",25),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.createdAt,"MMMM dd, y , hh:mm:ss a")," ")}}function z(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Status"),t.qZA())}function L(n,a){1&n&&(t.TgZ(0,"span",29),t._uU(1,"PENDING"),t.qZA())}function F(n,a){1&n&&(t.TgZ(0,"span",30),t._uU(1,"RESOLVED"),t.qZA())}function b(n,a){if(1&n&&(t.TgZ(0,"td",25),t.YNc(1,L,2,0,"span",27),t.YNc(2,F,2,0,"span",28),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf","PENDING"==e.status),t.xp6(1),t.Q6J("ngIf","RESOLVED"==e.status)}}function E(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1," Action"),t.qZA())}function q(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",25)(1,"mat-icon",31),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.reply(i))}),t._uU(2,"reply"),t.qZA(),t.TgZ(3,"mat-icon",32),t._uU(4,"remove_circle"),t.qZA()()}}function G(n,a){1&n&&t._UZ(0,"tr",33)}function H(n,a){1&n&&t._UZ(0,"tr",34)}function $(n,a){1&n&&(t.TgZ(0,"tr",35)(1,"td",36),t._uU(2,"No data matching the filter "),t.qZA()())}const j=function(){return[15,25,50,75,100]},W=[{path:"",component:(()=>{class n{constructor(e,o,r){this.supportService=e,this.ngxService=o,this.matdialog=r,this.displayedColumns=["name","email","time","title","status","reply"],this.dataSource=[],this.showLoader=!1,this.newTicketIssue="";let i=localStorage.getItem("userinfo");i&&(this.parseData=JSON.parse(i))}ngOnInit(){this.initializeFilter(),this.getData()}getData(){var e=this;return(0,x.Z)(function*(){yield e.getSupport()})()}initializeFilter(){this.filter={token:this.parseData.token,page:1,limit:15}}getSupport(){var e=this;return(0,x.Z)(function*(){e.showLoader=!0,e.ngxService.start();try{const o=yield e.supportService.getsupportData(e.filter).toPromise();e.dataSource=o.data.results,e.Replies=o.data.results[0].issue[0],e.totalLength=o.data.count,e.showLoader=!1}catch{e.showLoader=!1}})()}pageChange(e){this.filter.page=e.pageIndex+1,this.filter.limit=e.pageSize,this.getSupport()}reply(e){this.matdialog.open(U,{width:"450px",data:e})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v),t.Y36(g.LA),t.Y36(u.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-support"]],viewQuery:function(e,o){if(1&e&&t.Gf(f.NW,7),2&e){let r;t.iGM(r=t.CRH())&&(o.paginator=r.first)}},decls:30,vars:7,consts:[["class","ngxLoader",4,"ngIf"],[1,"main_container"],[1,"flex","pad-8","header"],[1,"heading"],[1,"spacer"],[2,"margin-top","10px"],["mat-table","",1,"dataTable",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","capital",4,"matCellDef"],["matColumnDef","email"],["mat-cell","",4,"matCellDef"],["matColumnDef","title"],["mat-cell","","style","color: red; text-transform: capitalize;",4,"matCellDef"],["matColumnDef","time"],["matColumnDef","status"],["matColumnDef","reply"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","cursor-pointer",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["pageSize","15",1,"pagination",3,"length","pageSizeOptions","page"],[1,"ngxLoader"],[3,"hasProgressBar"],["mat-header-cell",""],["mat-cell","",1,"capital"],["mat-cell",""],["mat-cell","",2,"color","red","text-transform","capitalize"],["style","color: #f5bb8c;",4,"ngIf"],["style","color: green;",4,"ngIf"],[2,"color","#f5bb8c"],[2,"color","green"],["matTooltip","Reply To User",1,"pointer","reply",3,"click"],["matTooltip","Remove Ticket",1,"remove"],["mat-header-row",""],["mat-row","",1,"cursor-pointer"],[1,"mat-row"],["colspan","5",1,"pad-16",2,"text-align","center"]],template:function(e,o){1&e&&(t.YNc(0,w,2,1,"div",0),t.TgZ(1,"div",1)(2,"div",2)(3,"p",3),t._uU(4,"Support "),t.qZA(),t._UZ(5,"div",4),t.qZA(),t.TgZ(6,"div",5)(7,"table",6),t.ynx(8,7),t.YNc(9,I,2,0,"th",8),t.YNc(10,P,2,2,"td",9),t.BQk(),t.ynx(11,10),t.YNc(12,Y,2,0,"th",8),t.YNc(13,R,2,1,"td",11),t.BQk(),t.ynx(14,12),t.YNc(15,J,2,0,"th",8),t.YNc(16,Q,2,1,"td",13),t.BQk(),t.ynx(17,14),t.YNc(18,k,2,0,"th",8),t.YNc(19,B,3,4,"td",11),t.BQk(),t.ynx(20,15),t.YNc(21,z,2,0,"th",8),t.YNc(22,b,3,2,"td",11),t.BQk(),t.ynx(23,16),t.YNc(24,E,2,0,"th",8),t.YNc(25,q,5,0,"td",11),t.BQk(),t.YNc(26,G,1,0,"tr",17),t.YNc(27,H,1,0,"tr",18),t.YNc(28,$,3,0,"tr",19),t.qZA(),t.TgZ(29,"mat-paginator",20),t.NdJ("page",function(i){return o.pageChange(i)}),t.qZA()()()),2&e&&(t.Q6J("ngIf",o.showLoader),t.xp6(7),t.Q6J("dataSource",o.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(2),t.Q6J("length",o.totalLength)("pageSizeOptions",t.DdM(6,j)))},dependencies:[c.O5,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,p.Ee,f.NW,g.Eo,h.Hw,_.gM,c.uU],styles:[".main_container[_ngcontent-%COMP%]{padding:0 10px}.reply[_ngcontent-%COMP%]{margin-right:5px}.reply[_ngcontent-%COMP%]:hover{color:#1e88e5}.remove[_ngcontent-%COMP%]:hover{cursor:pointer;color:green}"]}),n})()}];let V=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[T.Bz.forChild(W),T.Bz]}),n})();var X=s(1728);let K=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[c.ez,V,p.p0,f.TU,g.Js,d.u5,h.Ps,Z.c,_.AV,M.g0,u.Is,X.ot]}),n})()}}]);